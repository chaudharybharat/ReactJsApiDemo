{"ast":null,"code":"(function (a, b) {\n  \"object\" == typeof exports && \"undefined\" != typeof module ? module.exports = b(require(\"@babel/runtime/helpers/objectWithoutProperties\"), require(\"@babel/runtime/helpers/classCallCheck\"), require(\"@babel/runtime/helpers/createClass\"), require(\"@babel/runtime/helpers/possibleConstructorReturn\"), require(\"@babel/runtime/helpers/getPrototypeOf\"), require(\"@babel/runtime/helpers/assertThisInitialized\"), require(\"@babel/runtime/helpers/inherits\"), require(\"@babel/runtime/helpers/defineProperty\"), require(\"react\"), require(\"prop-types\")) : \"function\" == typeof define && define.amd ? define([\"@babel/runtime/helpers/objectWithoutProperties\", \"@babel/runtime/helpers/classCallCheck\", \"@babel/runtime/helpers/createClass\", \"@babel/runtime/helpers/possibleConstructorReturn\", \"@babel/runtime/helpers/getPrototypeOf\", \"@babel/runtime/helpers/assertThisInitialized\", \"@babel/runtime/helpers/inherits\", \"@babel/runtime/helpers/defineProperty\", \"react\", \"prop-types\"], b) : (a = a || self, a.Img = b(a._objectWithoutProperties, a._classCallCheck, a._createClass, a._possibleConstructorReturn, a._getPrototypeOf, a._assertThisInitialized, a._inherits, a._defineProperty, a.React, a.propTypes));\n})(this, function (a, b, c, d, e, f, g, h, i, j) {\n  'use strict';\n\n  function k(a, b) {\n    var c = Object.keys(a);\n\n    if (Object.getOwnPropertySymbols) {\n      var d = Object.getOwnPropertySymbols(a);\n      b && (d = d.filter(function (b) {\n        return Object.getOwnPropertyDescriptor(a, b).enumerable;\n      })), c.push.apply(c, d);\n    }\n\n    return c;\n  }\n\n  function l(a) {\n    for (var b, c = 1; c < arguments.length; c++) b = null == arguments[c] ? {} : arguments[c], c % 2 ? k(Object(b), !0).forEach(function (c) {\n      h(a, c, b[c]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(a, Object.getOwnPropertyDescriptors(b)) : k(Object(b)).forEach(function (c) {\n      Object.defineProperty(a, c, Object.getOwnPropertyDescriptor(b, c));\n    });\n\n    return a;\n  }\n\n  a = a && a.hasOwnProperty(\"default\") ? a[\"default\"] : a, b = b && b.hasOwnProperty(\"default\") ? b[\"default\"] : b, c = c && c.hasOwnProperty(\"default\") ? c[\"default\"] : c, d = d && d.hasOwnProperty(\"default\") ? d[\"default\"] : d, e = e && e.hasOwnProperty(\"default\") ? e[\"default\"] : e, f = f && f.hasOwnProperty(\"default\") ? f[\"default\"] : f, g = g && g.hasOwnProperty(\"default\") ? g[\"default\"] : g, h = h && h.hasOwnProperty(\"default\") ? h[\"default\"] : h;\n\n  var m = \"default\" in i ? i[\"default\"] : i,\n      n = {},\n      o = {\n    loader: j.node,\n    unloader: j.node,\n    decode: j.bool,\n    crossorigin: j.string,\n    src: j.oneOfType([j.string, j.array]),\n    container: j.func,\n    loaderContainer: j.func,\n    unloaderContainer: j.func\n  },\n      p = function (i) {\n    function j(a) {\n      var c;\n      b(this, j), c = d(this, e(j).call(this, a)), h(f(c), \"srcToArray\", function (a) {\n        return (Array.isArray(a) ? a : [a]).filter(function (a) {\n          return a;\n        });\n      }), h(f(c), \"onLoad\", function () {\n        n[c.sourceList[c.state.currentIndex]] = !0, c.i && c.setState({\n          isLoaded: !0\n        });\n      }), h(f(c), \"onError\", function () {\n        if (n[c.sourceList[c.state.currentIndex]] = !1, !c.i) return !1;\n\n        for (var a, b = c.state.currentIndex + 1; b < c.sourceList.length; b++) {\n          if (a = c.sourceList[b], !(a in n)) {\n            c.setState({\n              currentIndex: b\n            });\n            break;\n          }\n\n          if (!0 === n[a]) return c.setState({\n            currentIndex: b,\n            isLoading: !1,\n            isLoaded: !0\n          }), !0;\n          !1 === n[a];\n        }\n\n        return b === c.sourceList.length ? c.setState({\n          isLoading: !1\n        }) : void c.loadImg();\n      }), h(f(c), \"loadImg\", function () {\n        c.i = new Image(), c.i.src = c.sourceList[c.state.currentIndex], c.props.crossorigin && (c.i.crossOrigin = c.props.crossorigin), c.props.decode && c.i.decode ? c.i.decode().then(c.onLoad)[\"catch\"](c.onError) : (c.i.onload = c.onLoad, c.i.onerror = c.onError);\n      }), h(f(c), \"unloadImg\", function () {\n        c.i.onerror = null, c.i.onload = null, c.i.src = \"\";\n\n        try {\n          delete c.i.src;\n        } catch (a) {}\n\n        delete c.i;\n      }), c.loaderContainer = a.loaderContainer || a.container, c.unloaderContainer = a.unloaderContainer || a.container, c.sourceList = c.srcToArray(c.props.src);\n\n      for (var g = 0; g < c.sourceList.length && !!(c.sourceList[g] in n); g++) if (!0 === n[c.sourceList[g]]) return c.state = {\n        currentIndex: g,\n        isLoading: !1,\n        isLoaded: !0\n      }, d(c);\n\n      return c.state = c.sourceList.length ? {\n        currentIndex: 0,\n        isLoading: !0,\n        isLoaded: !1\n      } : {\n        isLoading: !1,\n        isLoaded: !1\n      }, c;\n    }\n\n    return g(j, i), c(j, [{\n      key: \"componentDidMount\",\n      value: function () {\n        this.state.isLoading && this.loadImg();\n      }\n    }, {\n      key: \"componentWillUnmount\",\n      value: function () {\n        this.i && this.unloadImg();\n      }\n    }, {\n      key: \"UNSAFE_componentWillReceiveProps\",\n      value: function (a) {\n        var b = this;\n        this.loaderContainer = a.loaderContainer || a.container, this.unloaderContainer = a.unloaderContainer || a.container;\n        var c = this.srcToArray(a.src),\n            d = c.filter(function (a) {\n          return -1 === b.sourceList.indexOf(a);\n        }),\n            e = this.sourceList.filter(function (a) {\n          return -1 === c.indexOf(a);\n        });\n\n        if (d.length || e.length) {\n          if (this.sourceList = c, !c.length) return this.setState({\n            isLoading: !1,\n            isLoaded: !1\n          });\n          this.setState({\n            currentIndex: 0,\n            isLoading: !0,\n            isLoaded: !1\n          }, this.loadImg);\n        }\n      }\n    }, {\n      key: \"render\",\n      value: function () {\n        var b = this.props,\n            c = b.container,\n            d = b.loader,\n            e = b.unloader,\n            f = b.src,\n            g = b.decode,\n            h = b.loaderContainer,\n            i = b.unloaderContainer,\n            j = b.mockImage,\n            k = a(b, [\"container\", \"loader\", \"unloader\", \"src\", \"decode\", \"loaderContainer\", \"unloaderContainer\", \"mockImage\"]);\n\n        if (this.state.isLoaded) {\n          var n = l({}, {\n            src: this.sourceList[this.state.currentIndex]\n          }, {}, k);\n          return c(m.createElement(\"img\", n));\n        }\n\n        return !this.state.isLoaded && this.state.isLoading ? d ? this.loaderContainer(d) : null : this.state.isLoaded || this.state.isLoading ? void 0 : e ? this.unloaderContainer(e) : null;\n      }\n    }]), j;\n  }(i.Component);\n\n  return h(p, \"defaultProps\", {\n    loader: !1,\n    unloader: !1,\n    decode: !0,\n    src: [],\n    container: function (a) {\n      return a;\n    }\n  }), p.propTypes = {}, p;\n});","map":{"version":3,"sources":["../src/index.js"],"names":["cache","imgPropTypes","loader","node","unloader","decode","bool","crossorigin","string","src","oneOfType","array","container","func","loaderContainer","unloaderContainer","Img","Component","x","props","sourceList","_this","i","length","state","currentIndex","isLoading","isLoaded","Array","nextIndex","setState","crossOrigin","then","onLoad","onload","onerror","nextProps","srcAdded","srcRemoved","loadImg","mockImage","rest","imgProps","React"],"mappings":"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","sourcesContent":["import React, {Component} from 'react'\nimport {\n  node,\n  func,\n  oneOfType,\n  string,\n  array,\n  bool,\n  instanceOf\n} from 'prop-types'\n\nconst cache = {}\nconst imgPropTypes = {\n  loader: node,\n  unloader: node,\n  decode: bool,\n  crossorigin: string,\n  src: oneOfType([string, array]),\n  container: func,\n  loaderContainer: func,\n  unloaderContainer: func\n}\n\nif (process.env.NODE_ENV != 'production' && process.env.NODE_ENV != 'test') {\n  imgPropTypes.containermockImage = instanceOf(Image) //used for testing only\n}\n\nclass Img extends Component {\n  static propTypes = imgPropTypes\n\n  static defaultProps = {\n    loader: false,\n    unloader: false,\n    decode: true,\n    src: [],\n    // by default, just return what gets sent in. Can be used for advanced rendering\n    // such as animations\n    container: x => x\n  }\n\n  constructor(props) {\n    super(props)\n\n    // default loader/unloader container to just container. If no container was set\n    // this will be a noop\n    this.loaderContainer = props.loaderContainer || props.container\n    this.unloaderContainer = props.unloaderContainer || props.container\n\n    this.sourceList = this.srcToArray(this.props.src)\n\n    // check cache to decide at which index to start\n    for (let i = 0; i < this.sourceList.length; i++) {\n      // if we've never seen this image before, the cache wont help.\n      // no need to look further, just start loading\n      /* istanbul ignore else */\n      if (!(this.sourceList[i] in cache)) break\n\n      // if we have loaded this image before, just load it again\n      /* istanbul ignore else */\n      if (cache[this.sourceList[i]] === true) {\n        this.state = {currentIndex: i, isLoading: false, isLoaded: true}\n        return\n      }\n    }\n\n    this.state = this.sourceList.length\n      ? // 'normal' opperation: start at 0 and try to load\n        {currentIndex: 0, isLoading: true, isLoaded: false}\n      : // if we dont have any sources, jump directly to unloaded\n        {isLoading: false, isLoaded: false}\n  }\n\n  srcToArray = src => (Array.isArray(src) ? src : [src]).filter(x => x)\n\n  onLoad = () => {\n    cache[this.sourceList[this.state.currentIndex]] = true\n    /* istanbul ignore else */\n    if (this.i) this.setState({isLoaded: true})\n  }\n\n  onError = () => {\n    cache[this.sourceList[this.state.currentIndex]] = false\n    // if the current image has already been destroyed, we are probably no longer mounted\n    // no need to do anything then\n    /* istanbul ignore else */\n    if (!this.i) return false\n\n    // before loading the next image, check to see if it was ever loaded in the past\n    for (\n      var nextIndex = this.state.currentIndex + 1;\n      nextIndex < this.sourceList.length;\n      nextIndex++\n    ) {\n      // get next img\n      let src = this.sourceList[nextIndex]\n\n      // if we have never seen it, its the one we want to try next\n      if (!(src in cache)) {\n        this.setState({currentIndex: nextIndex})\n        break\n      }\n\n      // if we know it exists, use it!\n      if (cache[src] === true) {\n        this.setState({\n          currentIndex: nextIndex,\n          isLoading: false,\n          isLoaded: true\n        })\n        return true\n      }\n\n      // if we know it doesn't exist, skip it!\n      /* istanbul ignore else */\n      if (cache[src] === false) continue\n    }\n\n    // currentIndex is zero bases, length is 1 based.\n    // if we have no more sources to try, return - we are done\n    if (nextIndex === this.sourceList.length)\n      return this.setState({isLoading: false})\n\n    // otherwise, try the next img\n    this.loadImg()\n  }\n\n  loadImg = () => {\n    if (process.env.NODE_ENV != 'production') {\n      this.i = this.props.mockImage || new Image()\n    } else {\n      this.i = new Image()\n    }\n    this.i.src = this.sourceList[this.state.currentIndex]\n\n    if (this.props.crossorigin) {\n      this.i.crossOrigin = this.props.crossorigin\n    }\n\n    if (this.props.decode && this.i.decode) {\n      this.i\n        .decode()\n        .then(this.onLoad)\n        .catch(this.onError)\n    } else {\n      this.i.onload = this.onLoad\n      this.i.onerror = this.onError\n    }\n  }\n\n  unloadImg = () => {\n    this.i.onerror = null\n    this.i.onload = null\n\n    // abort any current downloads https://github.com/mbrevda/react-image/pull/223\n    this.i.src = ''\n\n    try {\n      delete this.i.src\n    } catch (e) {\n      // On Safari in Strict mode this will throw an exception,\n      //  - https://github.com/mbrevda/react-image/issues/187\n      // We don't need to do anything about it.\n    }\n    delete this.i\n  }\n\n  componentDidMount() {\n    // kick off process\n    /* istanbul ignore else */\n    if (this.state.isLoading) this.loadImg()\n  }\n\n  componentWillUnmount() {\n    // ensure that we dont leave any lingering listeners\n    /* istanbul ignore else */\n    if (this.i) this.unloadImg()\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    this.loaderContainer = nextProps.loaderContainer || nextProps.container\n    this.unloaderContainer = nextProps.unloaderContainer || nextProps.container\n\n    let src = this.srcToArray(nextProps.src)\n\n    let srcAdded = src.filter(s => this.sourceList.indexOf(s) === -1)\n    let srcRemoved = this.sourceList.filter(s => src.indexOf(s) === -1)\n\n    // if src prop changed, restart the loading process\n    if (srcAdded.length || srcRemoved.length) {\n      this.sourceList = src\n\n      // if we dont have any sources, jump directly to unloader\n      if (!src.length) return this.setState({isLoading: false, isLoaded: false})\n      this.setState(\n        {currentIndex: 0, isLoading: true, isLoaded: false},\n        this.loadImg\n      )\n    }\n  }\n\n  render() {\n    // set img props as rest\n    const {\n      container,\n      loader,\n      unloader,\n\n      // props to exclude from the rest property\n      src,\n      decode,\n      loaderContainer,\n      unloaderContainer,\n      mockImage,\n\n      ...rest\n    } = this.props //eslint-disable-line\n\n    // if we have loaded, show img\n    if (this.state.isLoaded) {\n      const imgProps = {\n        ...{src: this.sourceList[this.state.currentIndex]},\n        ...rest\n      }\n\n      return container(<img {...imgProps} />)\n    }\n\n    // if we are still trying to load, show img and a loader if requested\n    if (!this.state.isLoaded && this.state.isLoading) {\n      return loader ? this.loaderContainer(loader) : null\n    }\n\n    // if we have given up on loading, show a place holder if requested, or nothing\n    /* istanbul ignore else */\n    if (!this.state.isLoaded && !this.state.isLoading) {\n      return unloader ? this.unloaderContainer(unloader) : null\n    }\n  }\n}\n\nexport default Img\n"]},"metadata":{},"sourceType":"script"}